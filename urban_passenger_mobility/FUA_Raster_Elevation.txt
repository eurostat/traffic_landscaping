Functunal urban areas:

FUA_shape_file <- read_sf(path_to_shape_file, layer= name_layer) 
city_shape_file <- FUA_shape_file %>%
  dplyr::filter(URAU_CODE  == urban_area_of_interest)

city_shape_file <- st_transform(city_shape_file, st_crs("+proj=longlat"))
city_shape_file %>% 
  kableExtra::kable() %>% 
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover"))


Crop Raster Data:

population_data_path <- "data/nld_ppp_2020_UNadj_constrained.tif"
population_data      <- terra::rast(population_data_path)
population_data_city <- terra::crop(population_data, city_shape_file)
population_data_city <- terra::mask(population_data_city,terra::vect(city_shape_file))
population_data_city_brick <- raster::brick(population_data_city)

mapview::mapview(population_data_city_brick, alpha.regions = 0.5 )



Elevation:

elevation <- elevatr::get_elev_raster(city_shape_file,
                                      z = 12)
terra::writeRaster(elevation, 
                   filename = file.path(cleaned_data_folder,
                                        path_to_saved_elevation),
                   overwrite=TRUE)

ggplot() +
  layer_spatial(elevation) +
  geom_sf() +
  scale_fill_viridis_c() +
  labs(fill = "elevation") +
  theme_void() +
  theme(legend.position = "bottom")